# 並行性をどうモデル化するか：CSPとは何か

- 並行性と並列性
    ```
        並行性はコードの性質を指し、並列性は動作しているプログラムの性質を指す。
    ```
    ある2つの領域が並列に動作するようにコードを書いた時、プログラム内のその2つの領域は並列に動作しているようにみえるが、実際は、見た目にはわからないほど素早く逐次実行している。
    （CPUが1コアの場合）CPUのコンテキストは異なるプログラムの間で時間を共有するために切り替わり、十分に大まかな時間間隔では、複数のタスクが並列に実行しているようにみえる。
    同じプログラムのバイナリを2コアのマシンで実行すると、先のプログラムの2つの領域は実際に並列に動作している。

    1. 私たちが並列なコードを書いているのではなく、並列に走ってほしいと思う並行なコードを書いているだけである。並行性はプログラムのランタイムの性質であって、コードの性質ではない。
    2. 自分の書いた並行なコードが実際に並列に走っているかどうかを知らないで済む（そうあってほしい）私たちのプログラムの設計のもとにある抽象化層によってのみ可能。例えば言語自体の並行処理のプリミティブ、プログラムのランタイム、オペレーティングシステム、オペレーティングシステムが動作しているプラットフォーム（ハイパーバイザー、コンテナ、仮想マシンなどが該当）、さらに究極的にはCPUなどが当てはまる。
    3. 並列性は時間やコンテキストの機能である。コンテキストはある捜査がアトミックであると考えられる境界だと定義。もしコンテキストが5秒間に1秒かかる2つの操作を実行するのであれば、これらの操作が並列して実行されたものと考えることになるはず。もしコンテキストが1秒間だったら、操作を逐次的に実行する。
    コンテキストは時間に限定されない
    コンテキストはプログラムが稼働するプロセス、そのOSスレッド、あるいはマシンとも定義できる。
    あなたが定義するコンテキストに依存してアトミックな操作がアトミックであると考えられるように、平行な操作もあなたが定義するコンテキストに依存することで初めて正しいものとなる。
    すべて相対的なもの
    コンテキストがコンピュータだった場合、私のマシンで実行されているプロセスはあなたのマシンで動いているプロセスのロジックには影響を与えないと考えるのは妥当。
    両方のプロセスが計算機の処理を始めて、簡単な計算を実行した場合、私の計算結果はあなたの計算結果には影響を与えないはず。
    私たちのマシンはコンテキストで、各プロセスは平行な操作。
    先の例では、並行処理の操作を複数のマシン、オペレーティングシステム、プロセスといった観点で世界をとらえることで、並行操作を構成することにした。
    これらの抽象化によって正しい状態にできている。

    あるマシン上のプロセスは他のマシン上のプロセスに影響されないと想定してよい。（ここでは同じ分散システム上にいないと仮定）しかし、同じマシン上の2つのプロセスの場合、お互いのロジックに影響しないと想定してよいか？プロセスAがプロセスBが読み込んでいるファイルをいくつかを上書きしてしまうかもしれない、またセキュリティの十分考慮されていないOS上では、さらにプロセスAはプロセスBが読み込んでいるメモリを改変してしまうことがあるかもしれない。
    
    オペレーティングシステムのスレッドの境界で考えてみる。
    